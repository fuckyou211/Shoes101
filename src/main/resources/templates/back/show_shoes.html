<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>101Shoes | 后台管理</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="../css/animate.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">

    <link href="../css/plugins/slick/slick.css" rel="stylesheet">
    <link href="../css/plugins/slick/slick-theme.css" rel="stylesheet">

    <link href="../css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet">
    <link href="../css/plugins/jasny/jasny-bootstrap.min.css" rel="stylesheet">
    <link href="../css/admin.css" rel="stylesheet">

    <link href="../css/plugins/summernote/summernote.css" rel="stylesheet">
    <link href="../css/plugins/summernote/summernote-bs4.css" rel="stylesheet">
    <style>
        .image-imitation{
            padding:0%;
        }
        .radio.radio-inline{
            margin: 4px 12px;;
        }
        .icon-true{

            width:4px;

            height: 7px;

            border-bottom: 1px solid #aaa;

            border-right: 1px solid #aaa;

            margin:2px auto;

            -webkit-transform: rotate(45deg);

            -moz-transform: rotate(45deg);

            transform: rotate(45deg);

        }
        .tb-size{
            float: left;
            background-color: #fff;
            white-space: nowrap;
            width: auto!important;
            min-width: 10px;
            padding: 3px 12px;
            text-align: center;
            border: 1px solid #b8b7bd;
            color: #000;
            text-decoration: none;
            margin: 0px 6px;
            position:relative

        }
        .tb-size.active{
            border-color: #FF0036;
        }
        .tb-size:hover{
            border-color: #FF0036;
        }

        .tb-color{
            float: left;
            background-color: #fff;
            white-space: nowrap;
            width: auto!important;
            min-width: 10px;
            padding: 2px;
            text-align: center;
            border: 1px solid #b8b7bd;
            color: #000;
            text-decoration: none;
            margin: 0px 6px;
            position:relative

        }
        .tb-color img{
            height: 25px;
        }
        .tb-color.active{
            border-color: #FF0036;
        }
        .tb-color:hover{
            border-color: #FF0036;
        }
        .fa-check.red{
            position: absolute;
            bottom: 0;
            right: 0;
            color: red;
        }
    </style>
</head>
<body>
<div id="wrapper">

    <!-- 左侧导航栏 -->
    <div id="navigate">
        <navigate></navigate>
    </div>


    <!-- 右边主演部分 -->
    <div id="page-wrapper" class="gray-bg dashbard-1">
        <!-- 正上方一小条 -->
        <div id="navigate-assist">
            <navigate-assist></navigate-assist>
        </div>


        <!--这里是标题、指示的地方-->
        <div class="row wrapper border-bottom white-bg page-heading">
            <div class="col-lg-10">
                <h2>添加商品</h2>
                <ol class="breadcrumb">
                    <li>
                        <a href="../../admin/toback">Home</a>
                    </li>
                    <li>
                        <a>商品管理</a>
                    </li>
                    <li class="active">
                        <strong>查看商品</strong>
                    </li>
                </ol>
            </div>
            <div class="col-lg-2">

            </div>
        </div>

        <div class="wrapper wrapper-content animated fadeInRight ecommerce">
            <div class="row">
                <div class="col-lg-12">

                    <div class="ibox product-detail" id="shoesdetail">
                        <div class="ibox-content">

                            <div class="row">
                                <div class="col-md-5">
                                    <div class="product-images">

                                        <div class="image-imitation"  v-for="(item, index) in bigpics"  >
                                            <img :src="item"  class="img-responsive center-block" />
                                        </div>

                                    </div>

                                </div>
                                <div class="col-md-7">
                                    <h2 class="font-bold m-b-xs">{{ details.shoesname}}</h2>
                                    <ol class="breadcrumb">
                                        <li class="active"> <small>分类: </small></li>
                                        <li v-for="(item, index) in catalog">
                                            <small>
                                                {{item}}
                                            </small>
                                        </li>
                                    </ol>

                                    <hr>
                                    <div>
                                        <!--<button class="btn btn-primary pull-right">Add to cart</button>-->
                                        <h1 class="product-main-price">优惠价：¥{{details.ticketprice}}<small class="text-muted">原价：¥{{details.price}}</small> </h1>
                                    </div>
                                    <hr>
                                    <!--<h4>Product description</h4>-->
                                    <div class="">
                                        <fieldset class="form-horizontal">
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label">尺码:</label>
                                                <div class="col-sm-10">
                                                    <div v-for="(item,index) in sizelist">
                                                        <a href="javascript:void(0);" class="tb-size" :value="item.sizeid"
                                                            onclick="chooseSize(this)">
                                                            <span>{{item.size}}</span>
                                                            <i class="fa fa-check red hidden"></i>
                                                        </a>
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label">颜色:</label>
                                                <div class="col-sm-10">
                                                    <div v-for="(item, index) in colorpicandcolor">
                                                        <a href="javascript:void(0);" class="tb-color" :value="item.colorid"
                                                           onclick="chooseColor(this)" >
			                                            	<span data-toggle = "tooltip" :title="item.color" >
			                                            		<img :src="item.colorpic" class="img-responsive center-block "/>
			                                            	</span>
                                                            <i class="fa fa-check red hidden"></i>
                                                        </a>
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label">库存:</label>
                                                <div class="col-sm-10">
                                                    <div class="">
                                                        <label class="control-label">{{skuquantity}}</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label"><small class="text-muted">总库存:</small></label>
                                                <div class="col-sm-10">
                                                    <div class="">
                                                        <label class="control-label"><small class="text-muted">{{allquantity}}</small></label>
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>


                                    </div>
                                    <hr>
                                    <dl class="dl-horizontal m-t-md small">
                                        <h3>属性:</h3>
                                        <span v-for="(item, index) in propertys">
                                            <dt>{{item.property}}</dt>
                                            <dd>{{item.propertyvalue }}</dd>
                                        </span>
                                    </dl>
                                    <!--<div class="text-right">
                                        <div class="btn-group">
                                            <button class="btn btn-white btn-sm"><i class="fa fa-star"></i> Add to wishlist </button>
                                            <button class="btn btn-white btn-sm"><i class="fa fa-envelope"></i> Contact with author </button>
                                        </div>
                                    </div>-->


                                </div>
                            </div>

                        </div>

                        <!--鞋子详情介绍-->
                        <div class="text-center article-title" v-html="details.shoesdetails">
                        </div>


                        <div class="ibox-footer">
                            <span class="pull-right">
                                Full stock - <i class="fa fa-clock-o"></i> 14.04.2016 10:04 pm
                            </span>
                            The generated Lorem Ipsum is therefore always free
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!-- Mainly scripts -->
<script src="../js/jquery-3.1.1.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="../js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<!-- Custom and plugin javascript -->
<script src="../js/inspinia.js"></script>
<script src="../js/plugins/pace/pace.min.js"></script>

<!-- Jasny -->
<script src="../js/plugins/jasny/jasny-bootstrap.min.js"></script>

<!-- CodeMirror -->
<script src="../js/plugins/codemirror/codemirror.js"></script>
<script src="../js/plugins/codemirror/mode/xml/xml.js"></script>

<!-- SUMMERNOTE -->
<script src="../js/plugins/summernote/summernote.js"></script>

<script src="../js/plugins/slick/slick.min.js"></script>

<script src="../js/vue.js"></script>
<script src="../navigate/navigate.js"></script>
<script>new Vue({el:"#navigate"});new Vue({el:"#navigate-assist"})</script>







<script>
    function getShoesId(){
        var result;
        var url=window.location.search; //获取url中"?"符后的字串
        if(url.indexOf("?")!=-1){
            result = url.substr(url.indexOf("=")+1);
        }
        return result;
    }

    function getShoesDetail() {
        $.post({
            url:"getDetailAjax",
            dataType:"json",
            data:{"shoesid":getShoesId()},
            success:function (result) {
                loadDetail(result.data)
            },
            fail: function (err) {
                console.log(err)
            }
        })
    }
    function loadDetail(data){
        console.log(JSON.parse(data));
        var temp = JSON.parse(data);
        shoesvue.details = temp.details;
        shoesvue.colorpicandcolor = temp.colorpicandcolor;
        shoesvue.sizelist = temp.sizelist;
        shoesvue.propertys = temp.propertys;
        shoesvue.bigpics = temp.bigpics;
        shoesvue.allquantity = temp.totalQty;
        shoesvue.catalog = temp.catalog;
    }

    function chooseSize(obj) {
        //先判断是否已经被选中
        if($(obj).hasClass("active")){
            //如果被选中了，那么就取消选中
            $(obj).removeClass("active");
            $(obj).children('i').addClass('hidden');
        }
        else{
            //否则的话，先把所以的取消选中
            $(".tb-size").removeClass("active");
            $(".tb-size").children('i').addClass('hidden');

            //再给新选中的加样式
            $(obj).addClass("active");
            $(obj).children('i').removeClass('hidden');
        }

        getskuquantity();

    }
    function chooseColor(obj) {

        //先判断是否已经被选中
        if($(obj).hasClass("active")){
            //如果被选中了，那么就取消选中
            $(obj).removeClass("active");
            $(obj).children('i').addClass('hidden');
        }
        else{
            //否则的话，先把所以的取消选中
            $(".tb-color").removeClass("active");
            $(".tb-color").children('i').addClass('hidden');

            //再给新选中的加样式
            $(obj).addClass("active");
            $(obj).children('i').removeClass('hidden');
        }
        getskuquantity();
    }
    
    function getskuquantity() {
        var sizeid = "", colorid = "";
        $(".tb-size").each(function(i){
            if($(this).hasClass('active')){
                sizeid = $(this).attr("value");
            }
        });
        $(".tb-color").each(function(i){
            if($(this).hasClass('active')){
                colorid = $(this).attr("value");
            }
        });
        console.log(sizeid+"&&"+colorid);

        $.post({
            url:"getQtyAjax",
            dataType:"json",
            data:{"shoesid": getShoesId(),"sizeid":sizeid, "colorid":colorid},
            success:function (result) {
                console.log(result);
                shoesvue.skuquantity = result;
            },
            fail: function (err) {
                console.log(err)
            }
        })
    }
    
</script>

<script>
    var shoesvue = new Vue({
        el:"#shoesdetail",
        data:{
            shoes:[],
            colorpicandcolor:[],
            details:[],
            sizelist:[],
            propertys:[],
            bigpics:[],
            catalog:[],
            allquantity:0,
            skuquantity:0
        },
        watch:{
            bigpics:function(){
                this.$nextTick(function(){
                    //////方法
                    $('.product-images').slick({
                        dots: true
                    });
                });
            }
        }
    });

</script>

<script>
    $(document).ready(function(){
        //一些初始化
        //获取数据
        getShoesDetail();
        $('[data-toggle="tooltip"]').tooltip();
        // $('.product-images').slick({
        //     dots: true
        // });
    });
</script>
</body>
</html>